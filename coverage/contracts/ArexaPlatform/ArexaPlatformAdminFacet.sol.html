<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts\ArexaPlatform\ArexaPlatformAdminFacet.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">contracts/ArexaPlatform/</a> ArexaPlatformAdminFacet.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">41.67% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>5/12</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">33.33% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>20/60</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">50% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>5/10</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">50% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>7/14</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: UNLICENCED
/**
 * Copyright (C) 2023 AREXA
 */
pragma solidity ^0.8.9;
&nbsp;
import { LibBlackWhiteList } from "../base/BlackWhiteList/LibBlackWhiteList.sol";
&nbsp;
import { LibERC1155 } from "../base/ERC1155/base/LibERC1155.sol";
import { LibArexaPlatformShared } from "./Platform/LibArexaPlatform.sol";
import { LibArexaPlatformSubscriptions } from "./Platform/LibArexaPlatformSubscriptions.sol";
import { LibArexaPlatformT3 } from "./Platform/LibArexaPlatformT3.sol";
import { LibArexaPlatformT4 } from "./Platform/LibArexaPlatformT4.sol";
import { LibArexaPlatformT5 } from "./Platform/LibArexaPlatformT5.sol";
&nbsp;
import { ArexaTokenPool } from "./Platform/LibArexaPlatformStorage.sol";
&nbsp;
import { CallProtection } from "../base/Shared/ProtectedCall.sol";
import { ModifierRole } from "../base/AccessControl/ModifierRole.sol";
import { ModifierPausable } from "../base/TargetedPausable/ModifierPausable.sol";
import { LibArexaConst } from "./LibArexaConst.sol";
&nbsp;
contract ArexaPlatformAdminFacet is CallProtection, ModifierRole, ModifierPausable {
	constructor() {}
&nbsp;
	function getArexaTokenPool(uint8 _tokenType) external view <span class="missing-if-branch" title="else path not taken" >E</span>protectedCall returns (uint256 total, uint256 sold) {
		(total, sold) = LibArexaPlatformShared.getArexaTokenPool(_tokenType);
	}
&nbsp;
	function createSubscription(
		uint256 tokenType,
		uint16 year,
		uint8 month,
		uint256 quantity,
		uint256 min,
		uint256 max
	) external <span class="missing-if-branch" title="else path not taken" >E</span>protectedCall onlyRole(LibArexaConst.AREXA_ADMIN_ROLE) <span class="missing-if-branch" title="else path not taken" >E</span>whenNotPaused(LibArexaConst.FULL) returns (uint256 tokenId) {
		<span class="missing-if-branch" title="else path not taken" >E</span>require(
			tokenType == LibArexaConst.SUBSCR1_TOKEN_TYPE || tokenType == LibArexaConst.SUBSCR2_TOKEN_TYPE,
			"Only subscription token type is permitted!"
		);
		tokenId = LibArexaPlatformSubscriptions.createSubscriptions(msg.sender, tokenType, year, month, quantity, min, max);
		LibERC1155.setTokenURI(tokenId, LibERC1155.getTokenUri(tokenType));
	}
&nbsp;
	function payArexaTokenFromPool(
		uint8 poolType,
		address account,
		uint32 quantity
	) external <span class="missing-if-branch" title="else path not taken" >E</span>protectedCall <span class="missing-if-branch" title="else path not taken" >E</span>onlyRole(LibArexaConst.AREXA_ADMIN_ROLE) <span class="missing-if-branch" title="else path not taken" >E</span>whenNotPaused(LibArexaConst.FULL) {
		//Tier4
		//AREXA_TOKEN
		//Price: priceless ;)
		//Quantity: No limit to buy
		//transfer from pool to account
		<span class="missing-if-branch" title="else path not taken" >E</span>require(
			poolType == LibArexaConst.AREXA_TOKEN_POOL_AREXAINC ||
				poolType == LibArexaConst.AREXA_TOKEN_POOL_MARKETING ||
				poolType == LibArexaConst.AREXA_TOKEN_POOL_DEVELOPMENT,
			"Payout can be made from Arexa, Marketing or Development pool!"
		);
		LibArexaPlatformT4.payByArexaToken(poolType, account, quantity);
	}
&nbsp;
<span class="fstat-no" title="function not covered" >	function buySubscriptionAdmin(</span>
		address toAccount,
		uint256 tokenId,
		uint32 quantity,
		uint16 discountPercent
	) external protectedCall onlyRole(LibArexaConst.AREXA_ADMIN_ROLE) whenNotPaused(LibArexaConst.FULL) {
		//Tier1 Oracle or Tier2 Edge
		//Price: variable USDT/piece, based on algorithm
		//Quantity: 1 per account
		// uint256 balance = LibERC1155.balanceOf(msg.sender, tokenId);
		// require(balance == 0, "Only 1 token can be bought per account!");
<span class="cstat-no" title="statement not covered" >		LibArexaPlatformSubscriptions.buySubscription(tokenId, toAccount, quantity, discountPercent)</span>;
	}
&nbsp;
<span class="fstat-no" title="function not covered" >	function buyOracleSubscriptionAdmin(</span>
		address toAccount,
		uint32 quantity,
		uint16 discountPercent
	) external protectedCall onlyRole(LibArexaConst.AREXA_ADMIN_ROLE) whenNotPaused(LibArexaConst.FULL) {
		//Tier1 Oracle
		//SUBSCR1_TOKEN_TYPE
		//Price: variable USDT/piece, based on algorithm
		//Quantity: 1 per account
<span class="cstat-no" title="statement not covered" >		uint256 tokenId = LibArexaPlatformSubscriptions.getCurrentSubscriptionTokenId(LibArexaConst.SUBSCR1_TOKEN_TYPE);</span>
		// uint256 balance = LibERC1155.balanceOf(msg.sender, tokenId);
		// require(balance == 0, "Only 1 token can be bought per account!");
<span class="cstat-no" title="statement not covered" >		LibArexaPlatformSubscriptions.buySubscription(tokenId, toAccount, quantity, discountPercent)</span>;
	}
&nbsp;
<span class="fstat-no" title="function not covered" >	function buyEdgeSubscriptionAdmin(</span>
		address toAccount,
		uint32 quantity,
		uint16 discountPercent
	) external protectedCall onlyRole(LibArexaConst.AREXA_ADMIN_ROLE) whenNotPaused(LibArexaConst.FULL) {
		//Tier2 Edge
		//SUBSCR2_TOKEN_TYPE
		//Price: variable USDT/piece, based on algorithm
		//Quantity: 1 per account
<span class="cstat-no" title="statement not covered" >		uint256 tokenId = LibArexaPlatformSubscriptions.getCurrentSubscriptionTokenId(LibArexaConst.SUBSCR2_TOKEN_TYPE);</span>
		// uint256 balance = LibERC1155.balanceOf(msg.sender, tokenId);
		// require(balance == 1, "Only 1 token can be bought per account!");
<span class="cstat-no" title="statement not covered" >		LibArexaPlatformSubscriptions.buySubscription(tokenId, toAccount, quantity, discountPercent)</span>;
	}
&nbsp;
<span class="fstat-no" title="function not covered" >	function buyTraderTokenAdmin(</span>
		address toAccount,
		uint128 value,
		uint8 valueType,
		uint16 discountPercent
	) external protectedCall onlyRole(LibArexaConst.AREXA_ADMIN_ROLE) whenNotPaused(LibArexaConst.FULL) {
		//Tier3 Singularity
		//TRADER_TOKEN
		//Price: 1.0 USDT/piece
		//Quantity: No limit to buy
		//valueType: 0 is amount, 1 is quantity
<span class="cstat-no" title="statement not covered" >		LibArexaPlatformT3.buyTraderToken(msg.sender, toAccount, value, valueType, discountPercent)</span>;
	}
&nbsp;
<span class="fstat-no" title="function not covered" >	function buyArexaTokenAdmin(</span>
		address toAccount,
		uint128 value,
		uint8 valueType,
		uint16 discountPercent
	) external protectedCall onlyRole(LibArexaConst.AREXA_ADMIN_ROLE) whenNotPaused(LibArexaConst.FULL) {
		//Tier4
		//AREXA_TOKEN
		//Price: 0.1 USDT/piece
		//Quantity: No limit to buy
		//valueType: 0 is amount, 1 is quantity
<span class="cstat-no" title="statement not covered" >		LibArexaPlatformT4.buyArexaToken(toAccount, value, valueType, discountPercent)</span>;
	}
&nbsp;
	function buyMagic100TokenAdmin(
		address toAccount,
		uint16 discountPercent //1 means 0,01%, 100 means 1%, 10000 means 100%, 1564 means 15,64% discount
	) external <span class="missing-if-branch" title="else path not taken" >E</span>protectedCall onlyRole(LibArexaConst.AREXA_ADMIN_ROLE) <span class="missing-if-branch" title="else path not taken" >E</span>whenNotPaused(LibArexaConst.FULL) {
		//Tier5
		//MAGIC_TOKEN_ID
		//Price: 100.0 USDT/piece
		//An ADMIN can buy to itself token, and then transfer for free
&nbsp;
		LibArexaPlatformT5.buyMagic100Token(toAccount, discountPercent);
	}
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sat Apr 27 2024 17:27:27 GMT+0200 (közép-európai nyári idő)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
